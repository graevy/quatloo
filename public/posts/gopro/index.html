<!doctype html>
<html lang="en-us"><head>
    <title>print(&#34;hello!&#34;)</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="" />

    
    
    
    <link rel="stylesheet" href="../../css/theme.min.css">

    
    
    

    
</head>
<body>
        <div id="content" class="mx-auto"><header class="container mt-sm-5 mt-4 mb-4 mt-xs-1">
    <div class="row">
        <div class="col-sm-4 col-12 text-sm-right text-center pt-sm-4">
            <a href="../../" class="text-decoration-none">
                <img id="home-image" class="rounded-circle"
                    
                        
                            src="../../images/graevy.png"
                        
                    
                />
            </a>
        </div>
        <div class="col-sm-8 col-12 text-sm-left text-center">
            <h2 class="m-0 mb-2 mt-4">
                <a href="../../" class="text-decoration-none">
                    
                        graevy
                    
                </a>
            </h2>
            <p class="text-muted mb-1">
                
                    Software Engineer
                
            </p>
            <ul id="nav-links" class="list-inline mb-2">
                
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../resume/resume.pdf" title="CV">Resume (pdf)</a>
                    </li>
                
                    <li class="list-inline-item">
                        <a class="badge badge-white " href="../../posts/" title="Posts">Posts</a>
                    </li>
                
            </ul>
            <ul id="nav-social" class="list-inline">
                
                    <li class="list-inline-item mr-3">
                        <a href="https://github.com/graevy" target="_blank">
                            <i class="fab fa-github fa-1x text-muted"></i>
                        </a>
                    </li>
                
                    <li class="list-inline-item mr-3">
                        <a href="https://www.linkedin.com/in/avery-mallet-lawrence/" target="_blank">
                            <i class="fab fa-linkedin-in fa-1x text-muted"></i>
                        </a>
                    </li>
                
                    <li class="list-inline-item mr-3">
                        <a href="mailto:avry@pm.me" target="_blank">
                            <i class="fas fa-at fa-1x text-muted"></i>
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
    <hr />
</header>
<div class="container">
    <div class="pl-sm-4 ml-sm-5">
        <h3 id="gopro-gps-metadata">Gopro GPS Metadata</h3>
<p>My <a href="https://okmilo.com">startup</a> contract is about to end, so this is a good time for a writeup on the software I wrote to help me do field testing. I just want to clarify that this wasn&rsquo;t a coding contract, and that all of this was me working in my free time to interact with practical software.</p>
<p>In short, we were given gopro cameras to supplement field testing with video, but there was no quantitative positional data accompanying those tests. After poking around, I learned that GoPros do record GPX data (GPS XML), but extract it with either an unsupported 2017 desktop app or a paid phone app that didn&rsquo;t give me files.</p>
<p>First script was a quick python XML parser that I piped <code>strings</code> output into. I started writing an OOP structure but I feature-crept it once I understood the scope (multiple output formats) of what I was trying to achieve.</p>
<p>This was my first mistake: not immediately delving into the python ecosystem<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> for established tools. I&rsquo;d never tackled something this broad before in a short timespan<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>, and, being used to writing my own tools to learn fundamentals, I didn&rsquo;t do due diligence.</p>
<p>Second script generated gpx files from videos successfully. Great. I found someone else&rsquo;s script to parse the gpx buckets and lobotomized the user-friendly drag-and-drop interface inside it.</p>
<p>I tunnel-visioned on gpx file generation as a goal, and neglected a proper pipeline; <strong>my second mistake</strong>. I think I lost about a week to this<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup>. My script then became: generate gpx files -&gt; generate csv/kml/whatever from gpx files -&gt; delete gpx files. This was easy to rationalize; I was close to my goal, and if I cared about performance I wouldn&rsquo;t be using python. But, it made debugging a nightmare; objects were on disk instead of in memory, each test took minutes to run, directory handling was needless complication.</p>
<p>So, I did my first major refactor, piping my forked gpx script&rsquo;s output directly into <code>gpxpy</code>. Sometimes when you refactor, it clears your head, you know? Simplified processes are easier to map mentally, meaning fewer bugs, meaning better processes&hellip;there was a major &ldquo;zen of refactoring&rdquo; moment here. Everything was beautiful,</p>
<p>until I rigidly adhered to composition-over-inheritance, <strong>my third mistake</strong>. I didn&rsquo;t want to mutate the pristine track objects generated by <code>gpxpy</code>; I wrapped them in &ldquo;metatracks&rdquo;, themselves containing &ldquo;metasegments&rdquo; of points. A few sessions later there were 5 classes with colliding namespaces, all because I didn&rsquo;t want to add fields like &ldquo;gopro_serial&rdquo; or &ldquo;duration&rdquo; to a gpx track. I recently learned how rust handled compound objects, and sought to replicate it in a language that really wants you to use object trees. Lesson learned.</p>
<p>Now the script was executing flawlessly. I had gorgeous csv output to shove into google maps to show routes taken. Except the gpx data inside the gopros was buggy as hell. Points at coordinates 0,0, points in the middle of the pacific, timestamps from epoch&hellip;there is some synchronization issue that lasts anywhere from 0 to 30? seconds when a gopro starts recording video, where the data just can&rsquo;t be trusted. I had to write some sanity checking algorithms to strip bad data and sort output.</p>
<p>I tried three different tools to verify what I was seeing (one of which was gopro proprietary) and, well, the first few seconds of a gopro recording couldn&rsquo;t reliably tell me where anyone was standing. Our use-case mostly involved short recorded segments, leaving awkward gaps in field test data. This was <strong>my fourth mistake</strong>: My boss&rsquo; boss wanted us to use gopros; I should&rsquo;ve just ignored him and used phones<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup>.</p>
<p>So, that&rsquo;s how my gopro metadata extractor went. It took about a month. It works; gopros sometimes don&rsquo;t.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>After being frustrated with the design of the most popular gpx parsing package in python, I searched Rust and found something better and faster. My first mistake was compounded by narrowing in on one language.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>I had years to tinker with my ttrpg library while learning python at my old job, vs ASAP here&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>Averaging an hour a day, probably&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Credit to my boss for pushing me in that direction, but I was in too deep to pivot. You could call it sunk-cost avoidance, but I didn&rsquo;t know the gopro gpx data would be so awful; the mistake was really not combing over it before proceeding with feature creep.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>

    </div>

    

            </div>
        </div><footer class="text-center pb-1">
    <small class="text-muted">
        
            &copy; 2023 Avery Lawrence
        
        <br>
        Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>, <a href="https://github.com/austingebauer/devise" target="_blank">Devise</a>, git/hub, nginx, docker, ubuntu, digitalocean, cloudflare...
    </small>
</footer>
</body>
</html>
